{
  "mode": "gpu",
  "vars": {
    "B": 1,
    "T": 4,
    "C": 4,
    "NH": 4,
    "L": 12,
    "3C": 12,
    "4C": 16,
    "BTC": 64,
    "4BTC": 256
  },
  "chips": [
    {
      "chip_id": 0,
      "GridX": 4,
      "GridY": 4,
      "core_per_sm": 32,
      "streams": [
        {
          "id": 0,
          "source": [
            {
              "label": "matmul_1_in",
              "size": "BTC"
            }
          ],
          "prims": [
            {
              "type": "Matmul_f_gpu",
              "compose": {
                "grid_x": 4,
                "grid_y": 4,
                "block_x": 4,
                "block_y": 4,
                "require_sm": 4
              },
              "B": "B",
              "T": "T",
              "C": "C",
              "OC": "3C",
              "address": {
                "indata": "matmul_1_in",
                "outdata": "matmul_1_out"
              }
            },
            {
              "type": "Attention_f_gpu",
              "compose": {
                "grid_x": 4,
                "grid_y": 4,
                "block_x": 4,
                "block_y": 4,
                "require_sm": 4
              },
              "B": "B",
              "T": "T",
              "C": "C",
              "NH": "NH",
              "address": {
                "indata": "matmul_1_out",
                "outdata": "attention_1_out"
              }
            }
          ]
        }
      ]
    }
  ]
}