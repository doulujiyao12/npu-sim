{
  "vars": {
    "B": 4,
    "T": 4,
    "C": 4,
    "NH": 4,
    "L": 12,
    "3C": 12,
    "4C": 16,
    "BTC": 64,
    "4BTC": 256
  },
  "source": [
    {
      "dest": 0,
      "size": "BTC"
    },
    {
      "dest": 4,
      "size": "BTC"
    }
  ],
  "layers": [
    {
      "id": 0,
      "type": "Layernorm_f",
      "var": {
        "B": "B",
        "T": "T",
        "C": "C"
      },
      "cast": [
        {
          "dest": 1
        }
      ],
      "loop": "L"
    },
    {
      "id": 1,
      "type": "Matmul_f",
      "var": {
        "B": "B",
        "T": "T",
        "C": "C",
        "OC": "3C"
      },
      "cast": [
        {
          "dest": 2
        }
      ],
      "loop": "L"
    },
    {
      "id": 2,
      "type": "Attention_f",
      "var": {
        "B": "B",
        "T": "T",
        "C": "C",
        "NH": "NH"
      },
      "cast": [
        {
          "dest": 3
        }
      ],
      "loop": "L"
    },
    {
      "id": 3,
      "type": "Matmul_f",
      "var": {
        "B": "B",
        "T": "T",
        "C": "C",
        "OC": "C"
      },
      "cast": [
        {
          "dest": 4
        }
      ],
      "loop": "L"
    },
    {
      "id": 4,
      "type": "Residual_f",
      "var": {
        "N": "BTC"
      },
      "cast": [
        {
          "dest": 5
        },
        {
          "dest": 9
        }
      ],
      "loop": "L"
    },
    {
      "id": 5,
      "type": "Layernorm_f",
      "var": {
        "B": "B",
        "T": "T",
        "C": "C"
      },
      "cast": [
        {
          "dest": 6
        }
      ],
      "loop": "L"
    },
    {
      "id": 6,
      "type": "Matmul_f",
      "var": {
        "B": "B",
        "T": "T",
        "C": "C",
        "OC": "4C"
      },
      "cast": [
        {
          "dest": 7
        }
      ],
      "loop": "L",
      "split": {
        "type": "TP",
        "dim": 2,
        "slice": 2
      }
    },
    {
      "id": 7,
      "type": "Gelu_f",
      "var": {
        "N": "4BTC"
      },
      "cast": [
        {
          "dest": 8
        }
      ],
      "loop": "L"
    },
    {
      "id": 8,
      "type": "Matmul_f",
      "var": {
        "B": "B",
        "T": "T",
        "C": "4C",
        "OC": "C"
      },
      "cast": [
        {
          "dest": 9
        }
      ],
      "loop": "L"
    },
    {
      "id": 9,
      "type": "Residual_f",
      "var": {
        "N": "BTC"
      },
      "cast": [
        {
          "dest": -1,
          "loopout": "true"
        },
        {
          "dest": 0,
          "loopout": "false"
        },
        {
          "dest": 4,
          "loopout": "false"
        }
      ],
      "loop": "L",
      "merge": {
        "type": "TP",
        "dir": 1
      }
    }
  ]
}
