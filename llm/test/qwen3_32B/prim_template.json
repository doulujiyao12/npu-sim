[
    {
        "loop": "L",
        "id": 0,
        "worklist": [
            {
                "recv_cnt": 1,
                "cast": [
                    {
                        "dest": 1,
                        "tag": 14
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "BTC/4",
                        "sram_address": {
                            "indata": "layernorm1_in",
                            "outdata": "layernorm1_in"
                        }
                    },
                    {
                        "type": "rmsnorm_forward",
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "sram_address": {
                            "indata": "_layernorm1_in",
                            "outdata": "layernorm1_out"
                        },
                        "dram_address": {
                            "data": "layernorm1_data"
                        }
                    },
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "OC": "3C-R/4",
                        "sram_address": {
                            "indata": "_layernorm1_out",
                            "outdata": "matmul1_1_out"
                        },
                        "dram_address": {
                            "data": "matmul1_data"
                        }
                    },
                    {
                        "type": "rope_forward_pd",
                        "B": "B",
                        "T": "T",
                        "C": "3C-R/4",
                        "NH": "NH/4",
                        "R": "R",
                        "chunk": "CHUNK",
                        "sram_address": {
                            "indata": "matmul1_1_out",
                            "outdata": "rope1_out"
                        },
                        "dram_address": {
                            "data": "rope1_data"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "3CC-R/4",
                        "sram_address": {
                            "indata": "eternal_matmul1_1_w",
                            "outdata": "DEL_eternal_matmul1_1_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 42,
                "cast": [
                    {
                        "dest": 1,
                        "tag": 14
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3CC-R/4",
                        "sram_address": {
                            "indata": "eternal_matmul1_2_w",
                            "outdata": "eternal_matmul1_2_w"
                        }
                    },
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "OC": "3C-R/4",
                        "sram_address": {
                            "indata": "_layernorm1_out",
                            "outdata": "matmul1_2_out"
                        },
                        "dram_address": {
                            "data": "matmul1_data"
                        }
                    },
                    {
                        "type": "rope_forward_pd",
                        "B": "B",
                        "T": "T",
                        "C": "3C-R/4",
                        "NH": "NH/4",
                        "R": "R",
                        "chunk": "CHUNK",
                        "sram_address": {
                            "indata": "matmul1_2_out",
                            "outdata": "rope2_out"
                        },
                        "dram_address": {
                            "data": "rope2_data"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "3CC-R/4",
                        "sram_address": {
                            "indata": "eternal_matmul1_2_w",
                            "outdata": "DEL_eternal_matmul1_2_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 42,
                "cast": [
                    {
                        "dest": 1,
                        "tag": 14
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3CC-R/4",
                        "sram_address": {
                            "indata": "eternal_matmul1_3_w",
                            "outdata": "eternal_matmul1_3_w"
                        }
                    },
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "OC": "3C-R/4",
                        "sram_address": {
                            "indata": "_layernorm1_out",
                            "outdata": "matmul1_3_out"
                        },
                        "dram_address": {
                            "data": "matmul1_data"
                        }
                    },
                    {
                        "type": "rope_forward_pd",
                        "B": "B",
                        "T": "T",
                        "C": "3C-R/4",
                        "NH": "NH/4",
                        "R": "R",
                        "chunk": "CHUNK",
                        "sram_address": {
                            "indata": "matmul1_3_out",
                            "outdata": "rope3_out"
                        },
                        "dram_address": {
                            "data": "rope3_data"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "3CC-R/4",
                        "sram_address": {
                            "indata": "eternal_matmul1_3_w",
                            "outdata": "DEL_eternal_matmul1_3_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 42,
                "cast": [],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3CC-R/4",
                        "sram_address": {
                            "indata": "eternal_matmul1_4_w",
                            "outdata": "eternal_matmul1_4_w"
                        }
                    },
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "OC": "3C-R/4",
                        "sram_address": {
                            "indata": "layernorm1_out",
                            "outdata": "matmul1_4_out"
                        },
                        "dram_address": {
                            "data": "matmul1_data"
                        }
                    },
                    {
                        "type": "rope_forward_pd",
                        "B": "B",
                        "T": "T",
                        "C": "3C-R/4",
                        "NH": "NH/4",
                        "R": "R",
                        "chunk": "CHUNK",
                        "sram_address": {
                            "indata": "matmul1_4_out",
                            "outdata": "rope4_out"
                        },
                        "dram_address": {
                            "data": "rope4_data"
                        }
                    },
                    {
                        "type": "Merge_matmul",
                        "B": "B",
                        "T": "T/4",
                        "C": "3C-R/4",
                        "dim": 1,
                        "slice": 4,
                        "sram_address": {
                            "indata": "rope1_out rope2_out rope3_out rope4_out",
                            "outdata": "matmul1_out"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [
                    {
                        "dest": 1,
                        "tag": 14
                    }
                ],
                "prims": [
                    {
                        "type": "parse_output",
                        "size": "3BTC-R/4",
                        "sram_address": {
                            "indata": "matmul1_out",
                            "outdata": "matmul1_out"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 42,
                "cast": [],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3BTC-R/4",
                        "sram_address": {
                            "indata": "matmul1_out",
                            "outdata": "matmul1_out"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [
                    {
                        "dest": 1,
                        "tag": 14
                    }
                ],
                "prims": [
                    {
                        "type": "parse_output",
                        "size": "3BTC-R/4",
                        "sram_address": {
                            "indata": "matmul1_out",
                            "outdata": "matmul1_out"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 42,
                "cast": [],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3BTC-R/4",
                        "sram_address": {
                            "indata": "matmul1_out",
                            "outdata": "matmul1_out"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [
                    {
                        "dest": 1,
                        "tag": 14
                    }
                ],
                "prims": [
                    {
                        "type": "parse_output",
                        "size": "3BTC-R/4",
                        "sram_address": {
                            "indata": "matmul1_out",
                            "outdata": "matmul1_out"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 42,
                "cast": [],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3BTC-R/4",
                        "sram_address": {
                            "indata": "matmul1_out",
                            "outdata": "matmul1_out"
                        },
                        "note": "在进行完第一个matmul，做完all gather，假设matmul1_out就是需要继续做attention的列分片数据：B，T，3C/4"
                    },
                    {
                        "type": "Attention_f_pd",
                        "B": "B",
                        "T": "T",
                        "C": "C/4",
                        "NH": "NH/4",
                        "DH": "DH",
                        "R": "R",
                        "sram_address": {
                            "indata": "matmul1_out",
                            "outdata": "attention1_out"
                        },
                        "dram_address": {
                            "data": "attention1_data",
                            "out": "TODO"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [
                    {
                        "dest": 1,
                        "tag": 14
                    }
                ],
                "prims": [
                    {
                        "type": "parse_output",
                        "size": "3BTC/4",
                        "sram_address": {
                            "indata": "attention1_out",
                            "outdata": "attention1_out"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 42,
                "cast": [],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3BTC/4",
                        "sram_address": {
                            "indata": "attention1_out",
                            "outdata": "attention1_out"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [
                    {
                        "dest": 1,
                        "tag": 14
                    }
                ],
                "prims": [
                    {
                        "type": "parse_output",
                        "size": "3BTC/4",
                        "sram_address": {
                            "indata": "attention1_out",
                            "outdata": "attention1_out"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 42,
                "cast": [],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3BTC/4",
                        "sram_address": {
                            "indata": "attention1_out",
                            "outdata": "attention1_out"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [
                    {
                        "dest": 1,
                        "tag": 14
                    }
                ],
                "prims": [
                    {
                        "type": "parse_output",
                        "size": "3BTC/4",
                        "sram_address": {
                            "indata": "attention1_out",
                            "outdata": "attention1_out"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 42,
                "cast": [
                    {
                        "dest": 1,
                        "tag": 14
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3BTC/4",
                        "sram_address": {
                            "indata": "attention1_out",
                            "outdata": "attention1_out"
                        },
                        "note": "在进行完attention，做完all gather，假设attention1_out就是需要继续做第二个matmul的列分片数据：B，T/4，3C"
                    },
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "3C",
                        "OC": "C/4",
                        "sram_address": {
                            "indata": "_attention1_out",
                            "outdata": "matmul2_1_out"
                        },
                        "dram_address": {
                            "data": "matmul2_data"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "3CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul2_1_w",
                            "outdata": "DEL_eternal_matmul2_1_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 42,
                "cast": [
                    {
                        "dest": 1,
                        "tag": 14
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul2_2_w",
                            "outdata": "eternal_matmul2_2_w"
                        }
                    },
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "3C",
                        "OC": "C/4",
                        "sram_address": {
                            "indata": "_attention1_out",
                            "outdata": "matmul2_2_out"
                        },
                        "dram_address": {
                            "data": "matmul2_data"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "3CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul2_2_w",
                            "outdata": "DEL_eternal_matmul2_2_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 42,
                "cast": [
                    {
                        "dest": 1,
                        "tag": 14
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul2_3_w",
                            "outdata": "eternal_matmul2_3_w"
                        }
                    },
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "3C",
                        "OC": "C/4",
                        "sram_address": {
                            "indata": "_attention1_out",
                            "outdata": "matmul2_3_out"
                        },
                        "dram_address": {
                            "data": "matmul2_data"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "3CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul2_3_w",
                            "outdata": "DEL_eternal_matmul2_3_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 42,
                "cast": [],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul2_4_w",
                            "outdata": "eternal_matmul2_4_w"
                        }
                    },
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "3C",
                        "OC": "C/4",
                        "sram_address": {
                            "indata": "attention1_out",
                            "outdata": "matmul2_4_out"
                        },
                        "dram_address": {
                            "data": "matmul2_data"
                        }
                    },
                    {
                        "type": "Merge_matmul",
                        "B": "B",
                        "T": "T/4",
                        "C": "C/4",
                        "dim": 1,
                        "slice": 4,
                        "sram_address": {
                            "indata": "matmul2_1_out matmul2_2_out matmul2_3_out matmul2_4_out",
                            "outdata": "matmul2_out"
                        }
                    },
                    {
                        "type": "Residual_f",
                        "N": "BTC/4",
                        "sram_address": {
                            "indata": "layernorm1_in matmul2_out",
                            "outdata": "residual1_out"
                        },
                        "dram_address": {
                            "data": -1,
                            "out": "TODO"
                        }
                    },
                    {
                        "type": "rmsnorm_forward",
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "sram_address": {
                            "indata": "_residual1_out",
                            "outdata": "layernorm2_out"
                        },
                        "dram_address": {
                            "data": "layernorm2_data"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [
                    {
                        "dest": 1,
                        "tag": 14
                    }
                ],
                "prims": [
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "OC": "5C/4",
                        "sram_address": {
                            "indata": "_layernorm2_out",
                            "outdata": "matmul3_1_out"
                        },
                        "dram_address": {
                            "data": "matmul3_data"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul3_1_w",
                            "outdata": "DEL_eternal_matmul3_1_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 42,
                "cast": [
                    {
                        "dest": 1,
                        "tag": 14
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul3_2_w",
                            "outdata": "eternal_matmul3_2_w"
                        }
                    },
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "OC": "5C/4",
                        "sram_address": {
                            "indata": "_layernorm2_out",
                            "outdata": "matmul3_2_out"
                        },
                        "dram_address": {
                            "data": "matmul3_data"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul3_2_w",
                            "outdata": "DEL_eternal_matmul3_2_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 42,
                "cast": [
                    {
                        "dest": 1,
                        "tag": 14
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul3_3_w",
                            "outdata": "eternal_matmul3_3_w"
                        }
                    },
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "OC": "5C/4",
                        "sram_address": {
                            "indata": "_layernorm2_out",
                            "outdata": "matmul3_3_out"
                        },
                        "dram_address": {
                            "data": "matmul3_data"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul3_3_w",
                            "outdata": "DEL_eternal_matmul3_3_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 42,
                "cast": [],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul3_4_w",
                            "outdata": "eternal_matmul3_4_w"
                        }
                    },
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "OC": "5C/4",
                        "sram_address": {
                            "indata": "layernorm2_out",
                            "outdata": "matmul3_4_out"
                        },
                        "dram_address": {
                            "data": "matmul3_data"
                        }
                    },
                    {
                        "type": "Merge_matmul",
                        "B": "B",
                        "T": "T/4",
                        "C": "5C/4",
                        "dim": 1,
                        "slice": 4,
                        "sram_address": {
                            "indata": "matmul3_1_out matmul3_2_out matmul3_3_out matmul3_4_out",
                            "outdata": "matmul3_out"
                        }
                    },
                    {
                        "type": "Gelu_f",
                        "N": "5BTC/4",
                        "sram_address": {
                            "indata": "matmul3_out",
                            "outdata": "gelu1_out"
                        },
                        "dram_address": {
                            "data": "gelu1_data",
                            "out": "TODO"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [
                    {
                        "dest": 1,
                        "tag": 14
                    }
                ],
                "prims": [
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "5C",
                        "OC": "C/4",
                        "sram_address": {
                            "indata": "_gelu1_out",
                            "outdata": "matmul4_1_out"
                        },
                        "dram_address": {
                            "data": "matmul4_data"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul4_1_w",
                            "outdata": "DEL_eternal_matmul4_1_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 42,
                "cast": [
                    {
                        "dest": 1,
                        "tag": 14
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul4_2_w",
                            "outdata": "eternal_matmul4_2_w"
                        }
                    },
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "5C",
                        "OC": "C/4",
                        "sram_address": {
                            "indata": "_gelu1_out",
                            "outdata": "matmul4_2_out"
                        },
                        "dram_address": {
                            "data": "matmul4_data"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul4_2_w",
                            "outdata": "DEL_eternal_matmul4_2_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 42,
                "cast": [
                    {
                        "dest": 1,
                        "tag": 14
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul4_3_w",
                            "outdata": "eternal_matmul4_3_w"
                        }
                    },
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "5C",
                        "OC": "C/4",
                        "sram_address": {
                            "indata": "_gelu1_out",
                            "outdata": "matmul4_3_out"
                        },
                        "dram_address": {
                            "data": "matmul4_data"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul4_3_w",
                            "outdata": "DEL_eternal_matmul4_3_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 42,
                "cast": [
                    {
                        "dest": 8
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul4_4_w",
                            "outdata": "eternal_matmul4_4_w"
                        }
                    },
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "5C",
                        "OC": "C/4",
                        "sram_address": {
                            "indata": "gelu1_out",
                            "outdata": "matmul4_4_out"
                        },
                        "dram_address": {
                            "data": "matmul4_data"
                        }
                    },
                    {
                        "type": "Merge_matmul",
                        "B": "B",
                        "T": "T/4",
                        "C": "C/4",
                        "dim": 1,
                        "slice": 4,
                        "sram_address": {
                            "indata": "matmul4_1_out matmul4_2_out matmul4_3_out matmul4_4_out",
                            "outdata": "matmul4_out"
                        }
                    },
                    {
                        "type": "Residual_f",
                        "N": "BTC",
                        "sram_address": {
                            "indata": "residual1_out matmul4_out",
                            "outdata": "residual2_out"
                        },
                        "dram_address": {
                            "data": -1,
                            "out": "TODO"
                        }
                    }
                ]
            }
        ]
    },
    {
        "loop": "L",
        "id": 1,
        "worklist": [
            {
                "recv_cnt": 1,
                "cast": [],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "BTC/4",
                        "sram_address": {
                            "indata": "layernorm1_in",
                            "outdata": "layernorm1_in"
                        }
                    },
                    {
                        "type": "rmsnorm_forward",
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "sram_address": {
                            "indata": "_layernorm1_in",
                            "outdata": "layernorm1_out"
                        },
                        "dram_address": {
                            "data": "layernorm1_data"
                        }
                    },
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "OC": "3C-R/4",
                        "sram_address": {
                            "indata": "_layernorm1_out",
                            "outdata": "matmul1_1_out"
                        },
                        "dram_address": {
                            "data": "matmul1_data"
                        }
                    },
                    {
                        "type": "rope_forward_pd",
                        "B": "B",
                        "T": "T",
                        "C": "3C-R/4",
                        "NH": "NH/4",
                        "R": "R",
                        "chunk": "CHUNK",
                        "sram_address": {
                            "indata": "matmul1_1_out",
                            "outdata": "rope1_out"
                        },
                        "dram_address": {
                            "data": "rope1_data"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 14,
                "cast": [
                    {
                        "dest": 3,
                        "tag": 31
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3CC-R/4",
                        "sram_address": {
                            "indata": "eternal_matmul1_2_w",
                            "outdata": "eternal_matmul1_2_w"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "3CC-R/4",
                        "sram_address": {
                            "indata": "eternal_matmul1_1_w",
                            "outdata": "DEL_eternal_matmul1_1_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [],
                "prims": [
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "OC": "3C-R/4",
                        "sram_address": {
                            "indata": "_layernorm1_out",
                            "outdata": "matmul1_2_out"
                        },
                        "dram_address": {
                            "data": "matmul1_data"
                        }
                    },
                    {
                        "type": "rope_forward_pd",
                        "B": "B",
                        "T": "T",
                        "C": "3C-R/4",
                        "NH": "NH/4",
                        "R": "R",
                        "chunk": "CHUNK",
                        "sram_address": {
                            "indata": "matmul1_2_out",
                            "outdata": "rope2_out"
                        },
                        "dram_address": {
                            "data": "rope2_data"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 14,
                "cast": [
                    {
                        "dest": 3,
                        "tag": 31
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3CC-R/4",
                        "sram_address": {
                            "indata": "eternal_matmul1_3_w",
                            "outdata": "eternal_matmul1_3_w"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "3CC-R/4",
                        "sram_address": {
                            "indata": "eternal_matmul1_2_w",
                            "outdata": "DEL_eternal_matmul1_2_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [],
                "prims": [
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "OC": "3C-R/4",
                        "sram_address": {
                            "indata": "_layernorm1_out",
                            "outdata": "matmul1_3_out"
                        },
                        "dram_address": {
                            "data": "matmul1_data"
                        }
                    },
                    {
                        "type": "rope_forward_pd",
                        "B": "B",
                        "T": "T",
                        "C": "3C-R/4",
                        "NH": "NH/4",
                        "R": "R",
                        "chunk": "CHUNK",
                        "sram_address": {
                            "indata": "matmul1_3_out",
                            "outdata": "rope3_out"
                        },
                        "dram_address": {
                            "data": "rope3_data"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 14,
                "cast": [
                    {
                        "dest": 3,
                        "tag": 31
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul1_4_w",
                            "outdata": "eternal_matmul1_4_w"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "3CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul1_3_w",
                            "outdata": "DEL_eternal_matmul1_3_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [],
                "prims": [
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "OC": "3C-R/4",
                        "sram_address": {
                            "indata": "layernorm1_out",
                            "outdata": "matmul1_4_out"
                        },
                        "dram_address": {
                            "data": "matmul1_data"
                        }
                    },
                    {
                        "type": "rope_forward_pd",
                        "B": "B",
                        "T": "T",
                        "C": "3C-R/4",
                        "NH": "NH/4",
                        "R": "R",
                        "chunk": "CHUNK",
                        "sram_address": {
                            "indata": "matmul1_4_out",
                            "outdata": "rope4_out"
                        },
                        "dram_address": {
                            "data": "rope4_data"
                        }
                    },
                    {
                        "type": "Merge_matmul",
                        "B": "B",
                        "T": "T/4",
                        "C": "C/4",
                        "dim": 1,
                        "slice": 4,
                        "sram_address": {
                            "indata": "rope1_out rope2_out rope3_out rope4_out",
                            "outdata": "matmul1_out"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 14,
                "cast": [
                    {
                        "dest": 3,
                        "tag": 31
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3BTC-R/4",
                        "sram_address": {
                            "indata": "matmul1_out",
                            "outdata": "matmul1_out"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "3BTC-R/4",
                        "sram_address": {
                            "indata": "matmul1_out",
                            "outdata": "matmul1_out"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 14,
                "cast": [
                    {
                        "dest": 3,
                        "tag": 31
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3BTC-R/4",
                        "sram_address": {
                            "indata": "matmul1_out",
                            "outdata": "matmul1_out"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "3BTC-R/4",
                        "sram_address": {
                            "indata": "matmul1_out",
                            "outdata": "matmul1_out"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 14,
                "cast": [
                    {
                        "dest": 3,
                        "tag": 31
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3BTC-R/4",
                        "sram_address": {
                            "indata": "matmul1_out",
                            "outdata": "matmul1_out"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "3BTC-R/4",
                        "sram_address": {
                            "indata": "matmul1_out",
                            "outdata": "matmul1_out"
                        }
                    },
                    {
                        "type": "Attention_f_pd",
                        "B": "B",
                        "T": "T",
                        "C": "C/4",
                        "NH": "NH/4",
                        "DH": "DH",
                        "R": "R",
                        "sram_address": {
                            "indata": "matmul1_out",
                            "outdata": "attention1_out"
                        },
                        "dram_address": {
                            "data": "attention1_data",
                            "out": "TODO"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 14,
                "cast": [
                    {
                        "dest": 3,
                        "tag": 31
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3BTC/4",
                        "sram_address": {
                            "indata": "attention1_out",
                            "outdata": "attention1_out"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "3BTC/4",
                        "sram_address": {
                            "indata": "attention1_out",
                            "outdata": "attention1_out"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 14,
                "cast": [
                    {
                        "dest": 3,
                        "tag": 31
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3BTC/4",
                        "sram_address": {
                            "indata": "attention1_out",
                            "outdata": "attention1_out"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "3BTC/4",
                        "sram_address": {
                            "indata": "attention1_out",
                            "outdata": "attention1_out"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 14,
                "cast": [
                    {
                        "dest": 3,
                        "tag": 31
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3BTC/4",
                        "sram_address": {
                            "indata": "attention1_out",
                            "outdata": "attention1_out"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "3BTC/4",
                        "sram_address": {
                            "indata": "attention1_out",
                            "outdata": "attention1_out"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [],
                "prims": [
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "3C",
                        "OC": "C/4",
                        "sram_address": {
                            "indata": "_attention1_out",
                            "outdata": "matmul2_1_out"
                        },
                        "dram_address": {
                            "data": "matmul2_data"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 14,
                "cast": [
                    {
                        "dest": 3,
                        "tag": 31
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul2_2_w",
                            "outdata": "eternal_matmul2_2_w"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "3CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul2_1_w",
                            "outdata": "DEL_eternal_matmul2_1_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [],
                "prims": [
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "3C",
                        "OC": "C/4",
                        "sram_address": {
                            "indata": "_attention1_out",
                            "outdata": "matmul2_2_out"
                        },
                        "dram_address": {
                            "data": "matmul2_data"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 14,
                "cast": [
                    {
                        "dest": 3,
                        "tag": 31
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul2_3_w",
                            "outdata": "eternal_matmul2_3_w"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "3CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul2_2_w",
                            "outdata": "DEL_eternal_matmul2_2_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [],
                "prims": [
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "3C",
                        "OC": "C/4",
                        "sram_address": {
                            "indata": "_attention1_out",
                            "outdata": "matmul2_3_out"
                        },
                        "dram_address": {
                            "data": "matmul2_data"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 14,
                "cast": [
                    {
                        "dest": 3,
                        "tag": 31
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul2_4_w",
                            "outdata": "eternal_matmul2_4_w"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "3CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul2_3_w",
                            "outdata": "DEL_eternal_matmul2_3_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [],
                "prims": [
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "3C",
                        "OC": "C/4",
                        "sram_address": {
                            "indata": "attention1_out",
                            "outdata": "matmul2_4_out"
                        },
                        "dram_address": {
                            "data": "matmul2_data"
                        }
                    },
                    {
                        "type": "Merge_matmul",
                        "B": "B",
                        "T": "T/4",
                        "C": "C/4",
                        "dim": 1,
                        "slice": 4,
                        "sram_address": {
                            "indata": "matmul2_1_out matmul2_2_out matmul2_3_out matmul2_4_out",
                            "outdata": "matmul2_out"
                        }
                    },
                    {
                        "type": "Residual_f",
                        "N": "BTC/4",
                        "sram_address": {
                            "indata": "layernorm1_in matmul2_out",
                            "outdata": "residual1_out"
                        },
                        "dram_address": {
                            "data": -1,
                            "out": "TODO"
                        }
                    },
                    {
                        "type": "rmsnorm_forward",
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "sram_address": {
                            "indata": "_residual1_out",
                            "outdata": "layernorm2_out"
                        },
                        "dram_address": {
                            "data": "layernorm2_data"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [],
                "prims": [
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "OC": "5C/4",
                        "sram_address": {
                            "indata": "_layernorm2_out",
                            "outdata": "matmul3_1_out"
                        },
                        "dram_address": {
                            "data": "matmul3_data"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 14,
                "cast": [
                    {
                        "dest": 3,
                        "tag": 31
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul3_2_w",
                            "outdata": "eternal_matmul3_2_w"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul3_1_w",
                            "outdata": "DEL_eternal_matmul3_1_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [],
                "prims": [
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "OC": "5C/4",
                        "sram_address": {
                            "indata": "_layernorm2_out",
                            "outdata": "matmul3_2_out"
                        },
                        "dram_address": {
                            "data": "matmul3_data"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 14,
                "cast": [
                    {
                        "dest": 3,
                        "tag": 31
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul3_3_w",
                            "outdata": "eternal_matmul3_3_w"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul3_2_w",
                            "outdata": "DEL_eternal_matmul3_2_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [],
                "prims": [
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "OC": "5C/4",
                        "sram_address": {
                            "indata": "_layernorm2_out",
                            "outdata": "matmul3_3_out"
                        },
                        "dram_address": {
                            "data": "matmul3_data"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 14,
                "cast": [
                    {
                        "dest": 3,
                        "tag": 31
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul3_4_w",
                            "outdata": "eternal_matmul3_4_w"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul3_3_w",
                            "outdata": "DEL_eternal_matmul3_3_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [],
                "prims": [
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "OC": "5C/4",
                        "sram_address": {
                            "indata": "layernorm2_out",
                            "outdata": "matmul3_4_out"
                        },
                        "dram_address": {
                            "data": "matmul3_data"
                        }
                    },
                    {
                        "type": "Merge_matmul",
                        "B": "B",
                        "T": "T/4",
                        "C": "5C/4",
                        "dim": 1,
                        "slice": 4,
                        "sram_address": {
                            "indata": "matmul3_1_out matmul3_2_out matmul3_3_out matmul3_4_out",
                            "outdata": "matmul3_out"
                        }
                    },
                    {
                        "type": "Gelu_f",
                        "N": "5BTC/4",
                        "sram_address": {
                            "indata": "matmul3_out",
                            "outdata": "gelu1_out"
                        },
                        "dram_address": {
                            "data": "gelu1_data",
                            "out": "TODO"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [],
                "prims": [
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "5C",
                        "OC": "C/4",
                        "sram_address": {
                            "indata": "_gelu1_out",
                            "outdata": "matmul4_1_out"
                        },
                        "dram_address": {
                            "data": "matmul4_data"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 14,
                "cast": [
                    {
                        "dest": 3,
                        "tag": 31
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul4_2_w",
                            "outdata": "eternal_matmul4_2_w"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul4_1_w",
                            "outdata": "DEL_eternal_matmul4_1_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [],
                "prims": [
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "5C",
                        "OC": "C/4",
                        "sram_address": {
                            "indata": "_gelu1_out",
                            "outdata": "matmul4_2_out"
                        },
                        "dram_address": {
                            "data": "matmul4_data"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 14,
                "cast": [
                    {
                        "dest": 3,
                        "tag": 31
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul4_3_w",
                            "outdata": "eternal_matmul4_3_w"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul4_2_w",
                            "outdata": "DEL_eternal_matmul4_2_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [],
                "prims": [
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "5C",
                        "OC": "C/4",
                        "sram_address": {
                            "indata": "_gelu1_out",
                            "outdata": "matmul4_3_out"
                        },
                        "dram_address": {
                            "data": "matmul4_data"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 14,
                "cast": [
                    {
                        "dest": 3,
                        "tag": 31
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul4_4_w",
                            "outdata": "eternal_matmul4_4_w"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul4_3_w",
                            "outdata": "DEL_eternal_matmul4_3_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [
                    {
                        "dest": 9
                    }
                ],
                "prims": [
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "5C",
                        "OC": "C/4",
                        "sram_address": {
                            "indata": "gelu1_out",
                            "outdata": "matmul4_4_out"
                        },
                        "dram_address": {
                            "data": "matmul4_data"
                        }
                    },
                    {
                        "type": "Merge_matmul",
                        "B": "B",
                        "T": "T/4",
                        "C": "C/4",
                        "dim": 1,
                        "slice": 4,
                        "sram_address": {
                            "indata": "matmul4_1_out matmul4_2_out matmul4_3_out matmul4_4_out",
                            "outdata": "matmul4_out"
                        }
                    },
                    {
                        "type": "Residual_f",
                        "N": "BTC",
                        "sram_address": {
                            "indata": "residual1_out matmul4_out",
                            "outdata": "residual2_out"
                        },
                        "dram_address": {
                            "data": -1,
                            "out": "TODO"
                        }
                    }
                ]
            }
        ]
    },
    {
        "loop": "L",
        "id": 3,
        "worklist": [
            {
                "recv_cnt": 1,
                "cast": [
                    {
                        "dest": 2,
                        "tag": 23
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "BTC/4",
                        "sram_address": {
                            "indata": "layernorm1_in",
                            "outdata": "layernorm1_in"
                        }
                    },
                    {
                        "type": "rmsnorm_forward",
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "sram_address": {
                            "indata": "_layernorm1_in",
                            "outdata": "layernorm1_out"
                        },
                        "dram_address": {
                            "data": "layernorm1_data"
                        }
                    },
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "OC": "3C-R/4",
                        "sram_address": {
                            "indata": "_layernorm1_out",
                            "outdata": "matmul1_1_out"
                        },
                        "dram_address": {
                            "data": "matmul1_data"
                        }
                    },
                    {
                        "type": "rope_forward_pd",
                        "B": "B",
                        "T": "T",
                        "C": "3C-R/4",
                        "NH": "NH/4",
                        "R": "R",
                        "chunk": "CHUNK",
                        "sram_address": {
                            "indata": "matmul1_1_out",
                            "outdata": "rope1_out"
                        },
                        "dram_address": {
                            "data": "rope1_data"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "3CC-R/4",
                        "sram_address": {
                            "indata": "eternal_matmul1_1_w",
                            "outdata": "DEL_eternal_matmul1_1_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 31,
                "cast": [
                    {
                        "dest": 2,
                        "tag": 23
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3CC-R/4",
                        "sram_address": {
                            "indata": "eternal_matmul1_2_w",
                            "outdata": "eternal_matmul1_2_w"
                        }
                    },
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "OC": "3C-R/4",
                        "sram_address": {
                            "indata": "_layernorm1_out",
                            "outdata": "matmul1_2_out"
                        },
                        "dram_address": {
                            "data": "matmul1_data"
                        }
                    },
                    {
                        "type": "rope_forward_pd",
                        "B": "B",
                        "T": "T",
                        "C": "3C-R/4",
                        "NH": "NH/4",
                        "R": "R",
                        "chunk": "CHUNK",
                        "sram_address": {
                            "indata": "matmul1_2_out",
                            "outdata": "rope2_out"
                        },
                        "dram_address": {
                            "data": "rope2_data"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "3CC-R/4",
                        "sram_address": {
                            "indata": "eternal_matmul1_2_w",
                            "outdata": "DEL_eternal_matmul1_2_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 31,
                "cast": [
                    {
                        "dest": 2,
                        "tag": 23
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3CC-R/4",
                        "sram_address": {
                            "indata": "eternal_matmul1_3_w",
                            "outdata": "eternal_matmul1_3_w"
                        }
                    },
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "OC": "3C-R/4",
                        "sram_address": {
                            "indata": "_layernorm1_out",
                            "outdata": "matmul1_3_out"
                        },
                        "dram_address": {
                            "data": "matmul1_data"
                        }
                    },
                    {
                        "type": "rope_forward_pd",
                        "B": "B",
                        "T": "T",
                        "C": "3C-R/4",
                        "NH": "NH/4",
                        "R": "R",
                        "chunk": "CHUNK",
                        "sram_address": {
                            "indata": "matmul1_3_out",
                            "outdata": "rope3_out"
                        },
                        "dram_address": {
                            "data": "rope3_data"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "3CC-R/4",
                        "sram_address": {
                            "indata": "eternal_matmul1_3_w",
                            "outdata": "DEL_eternal_matmul1_3_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 31,
                "cast": [],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3CC-R/4",
                        "sram_address": {
                            "indata": "eternal_matmul1_4_w",
                            "outdata": "eternal_matmul1_4_w"
                        }
                    },
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "OC": "3C-R/4",
                        "sram_address": {
                            "indata": "layernorm1_out",
                            "outdata": "matmul1_4_out"
                        },
                        "dram_address": {
                            "data": "matmul1_data"
                        }
                    },
                    {
                        "type": "rope_forward_pd",
                        "B": "B",
                        "T": "T",
                        "C": "3C-R/4",
                        "NH": "NH/4",
                        "R": "R",
                        "chunk": "CHUNK",
                        "sram_address": {
                            "indata": "matmul1_4_out",
                            "outdata": "rope4_out"
                        },
                        "dram_address": {
                            "data": "rope4_data"
                        }
                    },
                    {
                        "type": "Merge_matmul",
                        "B": "B",
                        "T": "T/4",
                        "C": "3C-R/4",
                        "dim": 1,
                        "slice": 4,
                        "sram_address": {
                            "indata": "rope1_out rope2_out rope3_out rope4_out",
                            "outdata": "matmul1_out"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [
                    {
                        "dest": 2,
                        "tag": 23
                    }
                ],
                "prims": [
                    {
                        "type": "parse_output",
                        "size": "3BTC-R/4",
                        "sram_address": {
                            "indata": "matmul1_out",
                            "outdata": "matmul1_out"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 31,
                "cast": [],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3BTC-R/4",
                        "sram_address": {
                            "indata": "matmul1_out",
                            "outdata": "matmul1_out"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [
                    {
                        "dest": 2,
                        "tag": 23
                    }
                ],
                "prims": [
                    {
                        "type": "parse_output",
                        "size": "3BTC-R/4",
                        "sram_address": {
                            "indata": "matmul1_out",
                            "outdata": "matmul1_out"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 31,
                "cast": [],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3BTC-R/4",
                        "sram_address": {
                            "indata": "matmul1_out",
                            "outdata": "matmul1_out"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [
                    {
                        "dest": 2,
                        "tag": 23
                    }
                ],
                "prims": [
                    {
                        "type": "parse_output",
                        "size": "3BTC-R/4",
                        "sram_address": {
                            "indata": "matmul1_out",
                            "outdata": "matmul1_out"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 31,
                "cast": [],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3BTC-R/4",
                        "sram_address": {
                            "indata": "matmul1_out",
                            "outdata": "matmul1_out"
                        },
                        "note": "在进行完第一个matmul，做完all gather，假设matmul1_out就是需要继续做attention的列分片数据：B，T，3C/4"
                    },
                    {
                        "type": "Attention_f_pd",
                        "B": "B",
                        "T": "T",
                        "C": "C/4",
                        "NH": "NH/4",
                        "DH": "DH",
                        "R": "R",
                        "sram_address": {
                            "indata": "matmul1_out",
                            "outdata": "attention1_out"
                        },
                        "dram_address": {
                            "data": "attention1_data",
                            "out": "TODO"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [
                    {
                        "dest": 2,
                        "tag": 23
                    }
                ],
                "prims": [
                    {
                        "type": "parse_output",
                        "size": "3BTC/4",
                        "sram_address": {
                            "indata": "attention1_out",
                            "outdata": "attention1_out"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 31,
                "cast": [],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3BTC/4",
                        "sram_address": {
                            "indata": "attention1_out",
                            "outdata": "attention1_out"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [
                    {
                        "dest": 2,
                        "tag": 23
                    }
                ],
                "prims": [
                    {
                        "type": "parse_output",
                        "size": "3BTC/4",
                        "sram_address": {
                            "indata": "attention1_out",
                            "outdata": "attention1_out"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 31,
                "cast": [],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3BTC/4",
                        "sram_address": {
                            "indata": "attention1_out",
                            "outdata": "attention1_out"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [
                    {
                        "dest": 2,
                        "tag": 23
                    }
                ],
                "prims": [
                    {
                        "type": "parse_output",
                        "size": "3BTC/4",
                        "sram_address": {
                            "indata": "attention1_out",
                            "outdata": "attention1_out"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 31,
                "cast": [
                    {
                        "dest": 2,
                        "tag": 23
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3BTC/4",
                        "sram_address": {
                            "indata": "attention1_out",
                            "outdata": "attention1_out"
                        },
                        "note": "在进行完attention，做完all gather，假设attention1_out就是需要继续做第二个matmul的列分片数据：B，T/4，3C"
                    },
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "3C",
                        "OC": "C/4",
                        "sram_address": {
                            "indata": "_attention1_out",
                            "outdata": "matmul2_1_out"
                        },
                        "dram_address": {
                            "data": "matmul2_data"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "3CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul2_1_w",
                            "outdata": "DEL_eternal_matmul2_1_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 31,
                "cast": [
                    {
                        "dest": 2,
                        "tag": 23
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul2_2_w",
                            "outdata": "eternal_matmul2_2_w"
                        }
                    },
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "3C",
                        "OC": "C/4",
                        "sram_address": {
                            "indata": "_attention1_out",
                            "outdata": "matmul2_2_out"
                        },
                        "dram_address": {
                            "data": "matmul2_data"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "3CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul2_2_w",
                            "outdata": "DEL_eternal_matmul2_2_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 31,
                "cast": [
                    {
                        "dest": 2,
                        "tag": 23
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul2_3_w",
                            "outdata": "eternal_matmul2_3_w"
                        }
                    },
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "3C",
                        "OC": "C/4",
                        "sram_address": {
                            "indata": "_attention1_out",
                            "outdata": "matmul2_3_out"
                        },
                        "dram_address": {
                            "data": "matmul2_data"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "3CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul2_3_w",
                            "outdata": "DEL_eternal_matmul2_3_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 31,
                "cast": [],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul2_4_w",
                            "outdata": "eternal_matmul2_4_w"
                        }
                    },
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "3C",
                        "OC": "C/4",
                        "sram_address": {
                            "indata": "attention1_out",
                            "outdata": "matmul2_4_out"
                        },
                        "dram_address": {
                            "data": "matmul2_data"
                        }
                    },
                    {
                        "type": "Merge_matmul",
                        "B": "B",
                        "T": "T/4",
                        "C": "C/4",
                        "dim": 1,
                        "slice": 4,
                        "sram_address": {
                            "indata": "matmul2_1_out matmul2_2_out matmul2_3_out matmul2_4_out",
                            "outdata": "matmul2_out"
                        }
                    },
                    {
                        "type": "Residual_f",
                        "N": "BTC/4",
                        "sram_address": {
                            "indata": "layernorm1_in matmul2_out",
                            "outdata": "residual1_out"
                        },
                        "dram_address": {
                            "data": -1,
                            "out": "TODO"
                        }
                    },
                    {
                        "type": "rmsnorm_forward",
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "sram_address": {
                            "indata": "_residual1_out",
                            "outdata": "layernorm2_out"
                        },
                        "dram_address": {
                            "data": "layernorm2_data"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [
                    {
                        "dest": 2,
                        "tag": 23
                    }
                ],
                "prims": [
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "OC": "5C/4",
                        "sram_address": {
                            "indata": "_layernorm2_out",
                            "outdata": "matmul3_1_out"
                        },
                        "dram_address": {
                            "data": "matmul3_data"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul3_1_w",
                            "outdata": "DEL_eternal_matmul3_1_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 31,
                "cast": [
                    {
                        "dest": 2,
                        "tag": 23
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul3_2_w",
                            "outdata": "eternal_matmul3_2_w"
                        }
                    },
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "OC": "5C/4",
                        "sram_address": {
                            "indata": "_layernorm2_out",
                            "outdata": "matmul3_2_out"
                        },
                        "dram_address": {
                            "data": "matmul3_data"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul3_2_w",
                            "outdata": "DEL_eternal_matmul3_2_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 31,
                "cast": [
                    {
                        "dest": 2,
                        "tag": 23
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul3_3_w",
                            "outdata": "eternal_matmul3_3_w"
                        }
                    },
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "OC": "5C/4",
                        "sram_address": {
                            "indata": "_layernorm2_out",
                            "outdata": "matmul3_3_out"
                        },
                        "dram_address": {
                            "data": "matmul3_data"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul3_3_w",
                            "outdata": "DEL_eternal_matmul3_3_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 31,
                "cast": [],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul3_4_w",
                            "outdata": "eternal_matmul3_4_w"
                        }
                    },
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "OC": "5C/4",
                        "sram_address": {
                            "indata": "layernorm2_out",
                            "outdata": "matmul3_4_out"
                        },
                        "dram_address": {
                            "data": "matmul3_data"
                        }
                    },
                    {
                        "type": "Merge_matmul",
                        "B": "B",
                        "T": "T/4",
                        "C": "5C/4",
                        "dim": 1,
                        "slice": 4,
                        "sram_address": {
                            "indata": "matmul3_1_out matmul3_2_out matmul3_3_out matmul3_4_out",
                            "outdata": "matmul3_out"
                        }
                    },
                    {
                        "type": "Gelu_f",
                        "N": "5BTC/4",
                        "sram_address": {
                            "indata": "matmul3_out",
                            "outdata": "gelu1_out"
                        },
                        "dram_address": {
                            "data": "gelu1_data",
                            "out": "TODO"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [
                    {
                        "dest": 2,
                        "tag": 23
                    }
                ],
                "prims": [
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "5C",
                        "OC": "C/4",
                        "sram_address": {
                            "indata": "_gelu1_out",
                            "outdata": "matmul4_1_out"
                        },
                        "dram_address": {
                            "data": "matmul4_data"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul4_1_w",
                            "outdata": "DEL_eternal_matmul4_1_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 31,
                "cast": [
                    {
                        "dest": 2,
                        "tag": 23
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul4_2_w",
                            "outdata": "eternal_matmul4_2_w"
                        }
                    },
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "5C",
                        "OC": "C/4",
                        "sram_address": {
                            "indata": "_gelu1_out",
                            "outdata": "matmul4_2_out"
                        },
                        "dram_address": {
                            "data": "matmul4_data"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul4_2_w",
                            "outdata": "DEL_eternal_matmul4_2_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 31,
                "cast": [
                    {
                        "dest": 2,
                        "tag": 23
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul4_3_w",
                            "outdata": "eternal_matmul4_3_w"
                        }
                    },
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "5C",
                        "OC": "C/4",
                        "sram_address": {
                            "indata": "_gelu1_out",
                            "outdata": "matmul4_3_out"
                        },
                        "dram_address": {
                            "data": "matmul4_data"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul4_3_w",
                            "outdata": "DEL_eternal_matmul4_3_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 31,
                "cast": [
                    {
                        "dest": 11
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul4_4_w",
                            "outdata": "eternal_matmul4_4_w"
                        }
                    },
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "5C",
                        "OC": "C/4",
                        "sram_address": {
                            "indata": "gelu1_out",
                            "outdata": "matmul4_4_out"
                        },
                        "dram_address": {
                            "data": "matmul4_data"
                        }
                    },
                    {
                        "type": "Merge_matmul",
                        "B": "B",
                        "T": "T/4",
                        "C": "C/4",
                        "dim": 1,
                        "slice": 4,
                        "sram_address": {
                            "indata": "matmul4_1_out matmul4_2_out matmul4_3_out matmul4_4_out",
                            "outdata": "matmul4_out"
                        }
                    },
                    {
                        "type": "Residual_f",
                        "N": "BTC",
                        "sram_address": {
                            "indata": "residual1_out matmul4_out",
                            "outdata": "residual2_out"
                        },
                        "dram_address": {
                            "data": -1,
                            "out": "TODO"
                        }
                    }
                ]
            }
        ]
    },
    {
        "loop": "L",
        "id": 2,
        "worklist": [
            {
                "recv_cnt": 1,
                "cast": [],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "BTC/4",
                        "sram_address": {
                            "indata": "layernorm1_in",
                            "outdata": "layernorm1_in"
                        }
                    },
                    {
                        "type": "rmsnorm_forward",
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "sram_address": {
                            "indata": "_layernorm1_in",
                            "outdata": "layernorm1_out"
                        },
                        "dram_address": {
                            "data": "layernorm1_data"
                        }
                    },
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "OC": "3C-R/4",
                        "sram_address": {
                            "indata": "_layernorm1_out",
                            "outdata": "matmul1_1_out"
                        },
                        "dram_address": {
                            "data": "matmul1_data"
                        }
                    },
                    {
                        "type": "rope_forward_pd",
                        "B": "B",
                        "T": "T",
                        "C": "3C-R/4",
                        "NH": "NH/4",
                        "R": "R",
                        "chunk": "CHUNK",
                        "sram_address": {
                            "indata": "matmul1_1_out",
                            "outdata": "rope1_out"
                        },
                        "dram_address": {
                            "data": "rope1_data"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 23,
                "cast": [
                    {
                        "dest": 0,
                        "tag": 42
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul1_2_w",
                            "outdata": "eternal_matmul1_2_w"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "3CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul1_1_w",
                            "outdata": "DEL_eternal_matmul1_1_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [],
                "prims": [
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "OC": "3C-R/4",
                        "sram_address": {
                            "indata": "_layernorm1_out",
                            "outdata": "matmul1_2_out"
                        },
                        "dram_address": {
                            "data": "matmul1_data"
                        }
                    },
                    {
                        "type": "rope_forward_pd",
                        "B": "B",
                        "T": "T",
                        "C": "3C-R/4",
                        "NH": "NH/4",
                        "R": "R",
                        "chunk": "CHUNK",
                        "sram_address": {
                            "indata": "matmul1_2_out",
                            "outdata": "rope2_out"
                        },
                        "dram_address": {
                            "data": "rope2_data"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 23,
                "cast": [
                    {
                        "dest": 0,
                        "tag": 42
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3CC-R/4",
                        "sram_address": {
                            "indata": "eternal_matmul1_3_w",
                            "outdata": "eternal_matmul1_3_w"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "3CC-R/4",
                        "sram_address": {
                            "indata": "eternal_matmul1_2_w",
                            "outdata": "DEL_eternal_matmul1_2_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [],
                "prims": [
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "OC": "3C-R/4",
                        "sram_address": {
                            "indata": "_layernorm1_out",
                            "outdata": "matmul1_3_out"
                        },
                        "dram_address": {
                            "data": "matmul1_data"
                        }
                    },
                    {
                        "type": "rope_forward_pd",
                        "B": "B",
                        "T": "T",
                        "C": "3C-R/4",
                        "NH": "NH/4",
                        "R": "R",
                        "chunk": "CHUNK",
                        "sram_address": {
                            "indata": "matmul1_3_out",
                            "outdata": "rope3_out"
                        },
                        "dram_address": {
                            "data": "rope3_data"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 23,
                "cast": [
                    {
                        "dest": 0,
                        "tag": 42
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3CC-R/4",
                        "sram_address": {
                            "indata": "eternal_matmul1_4_w",
                            "outdata": "eternal_matmul1_4_w"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "3CC-R/4",
                        "sram_address": {
                            "indata": "eternal_matmul1_3_w",
                            "outdata": "DEL_eternal_matmul1_3_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [],
                "prims": [
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "OC": "3C-R/4",
                        "sram_address": {
                            "indata": "layernorm1_out",
                            "outdata": "matmul1_4_out"
                        },
                        "dram_address": {
                            "data": "matmul1_data"
                        }
                    },
                    {
                        "type": "rope_forward_pd",
                        "B": "B",
                        "T": "T",
                        "C": "3C-R/4",
                        "NH": "NH/4",
                        "R": "R",
                        "chunk": "CHUNK",
                        "sram_address": {
                            "indata": "matmul1_4_out",
                            "outdata": "rope4_out"
                        },
                        "dram_address": {
                            "data": "rope4_data"
                        }
                    },
                    {
                        "type": "Merge_matmul",
                        "B": "B",
                        "T": "T/4",
                        "C": "C/4",
                        "dim": 1,
                        "slice": 4,
                        "sram_address": {
                            "indata": "rope1_out rope2_out rope3_out rope4_out",
                            "outdata": "matmul1_out"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 23,
                "cast": [
                    {
                        "dest": 0,
                        "tag": 42
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3BTC-R/4",
                        "sram_address": {
                            "indata": "matmul1_out",
                            "outdata": "matmul1_out"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "3BTC-R/4",
                        "sram_address": {
                            "indata": "matmul1_out",
                            "outdata": "matmul1_out"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 23,
                "cast": [
                    {
                        "dest": 0,
                        "tag": 42
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3BTC-R/4",
                        "sram_address": {
                            "indata": "matmul1_out",
                            "outdata": "matmul1_out"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "3BTC-R/4",
                        "sram_address": {
                            "indata": "matmul1_out",
                            "outdata": "matmul1_out"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 23,
                "cast": [
                    {
                        "dest": 0,
                        "tag": 42
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3BTC-R/4",
                        "sram_address": {
                            "indata": "matmul1_out",
                            "outdata": "matmul1_out"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "3BTC-R/4",
                        "sram_address": {
                            "indata": "matmul1_out",
                            "outdata": "matmul1_out"
                        }
                    },
                    {
                        "type": "Attention_f_pd",
                        "B": "B",
                        "T": "T",
                        "C": "C/4",
                        "NH": "NH/4",
                        "DH": "DH",
                        "R": "R",
                        "sram_address": {
                            "indata": "matmul1_out",
                            "outdata": "attention1_out"
                        },
                        "dram_address": {
                            "data": "attention1_data",
                            "out": "TODO"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 23,
                "cast": [
                    {
                        "dest": 0,
                        "tag": 42
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3BTC/4",
                        "sram_address": {
                            "indata": "attention1_out",
                            "outdata": "attention1_out"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "3BTC/4",
                        "sram_address": {
                            "indata": "attention1_out",
                            "outdata": "attention1_out"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 23,
                "cast": [
                    {
                        "dest": 0,
                        "tag": 42
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3BTC/4",
                        "sram_address": {
                            "indata": "attention1_out",
                            "outdata": "attention1_out"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "3BTC/4",
                        "sram_address": {
                            "indata": "attention1_out",
                            "outdata": "attention1_out"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 23,
                "cast": [
                    {
                        "dest": 0,
                        "tag": 42
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3BTC/4",
                        "sram_address": {
                            "indata": "attention1_out",
                            "outdata": "attention1_out"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "3BTC/4",
                        "sram_address": {
                            "indata": "attention1_out",
                            "outdata": "attention1_out"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [],
                "prims": [
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "3C",
                        "OC": "C/4",
                        "sram_address": {
                            "indata": "_attention1_out",
                            "outdata": "matmul2_1_out"
                        },
                        "dram_address": {
                            "data": "matmul2_data"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 23,
                "cast": [
                    {
                        "dest": 0,
                        "tag": 42
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul2_2_w",
                            "outdata": "eternal_matmul2_2_w"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "3CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul2_1_w",
                            "outdata": "DEL_eternal_matmul2_1_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [],
                "prims": [
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "3C",
                        "OC": "C/4",
                        "sram_address": {
                            "indata": "_attention1_out",
                            "outdata": "matmul2_2_out"
                        },
                        "dram_address": {
                            "data": "matmul2_data"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 23,
                "cast": [
                    {
                        "dest": 0,
                        "tag": 42
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul2_3_w",
                            "outdata": "eternal_matmul2_3_w"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "3CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul2_2_w",
                            "outdata": "DEL_eternal_matmul2_2_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [],
                "prims": [
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "3C",
                        "OC": "C/4",
                        "sram_address": {
                            "indata": "_attention1_out",
                            "outdata": "matmul2_3_out"
                        },
                        "dram_address": {
                            "data": "matmul2_data"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 23,
                "cast": [
                    {
                        "dest": 0,
                        "tag": 42
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "3CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul2_4_w",
                            "outdata": "eternal_matmul2_4_w"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "3CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul2_3_w",
                            "outdata": "DEL_eternal_matmul2_3_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [],
                "prims": [
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "3C",
                        "OC": "C/4",
                        "sram_address": {
                            "indata": "attention1_out",
                            "outdata": "matmul2_4_out"
                        },
                        "dram_address": {
                            "data": "matmul2_data"
                        }
                    },
                    {
                        "type": "Merge_matmul",
                        "B": "B",
                        "T": "T/4",
                        "C": "C/4",
                        "dim": 1,
                        "slice": 4,
                        "sram_address": {
                            "indata": "matmul2_1_out matmul2_2_out matmul2_3_out matmul2_4_out",
                            "outdata": "matmul2_out"
                        }
                    },
                    {
                        "type": "Residual_f",
                        "N": "BTC/4",
                        "sram_address": {
                            "indata": "layernorm1_in matmul2_out",
                            "outdata": "residual1_out"
                        },
                        "dram_address": {
                            "data": -1,
                            "out": "TODO"
                        }
                    },
                    {
                        "type": "rmsnorm_forward",
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "sram_address": {
                            "indata": "_residual1_out",
                            "outdata": "layernorm2_out"
                        },
                        "dram_address": {
                            "data": "layernorm2_data"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [],
                "prims": [
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "OC": "5C/4",
                        "sram_address": {
                            "indata": "_layernorm2_out",
                            "outdata": "matmul3_1_out"
                        },
                        "dram_address": {
                            "data": "matmul3_data"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 23,
                "cast": [
                    {
                        "dest": 0,
                        "tag": 42
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul3_2_w",
                            "outdata": "eternal_matmul3_2_w"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul3_1_w",
                            "outdata": "DEL_eternal_matmul3_1_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [],
                "prims": [
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "OC": "5C/4",
                        "sram_address": {
                            "indata": "_layernorm2_out",
                            "outdata": "matmul3_2_out"
                        },
                        "dram_address": {
                            "data": "matmul3_data"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 23,
                "cast": [
                    {
                        "dest": 0,
                        "tag": 42
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul3_3_w",
                            "outdata": "eternal_matmul3_3_w"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul3_2_w",
                            "outdata": "DEL_eternal_matmul3_2_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [],
                "prims": [
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "OC": "5C/4",
                        "sram_address": {
                            "indata": "_layernorm2_out",
                            "outdata": "matmul3_3_out"
                        },
                        "dram_address": {
                            "data": "matmul3_data"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 23,
                "cast": [
                    {
                        "dest": 0,
                        "tag": 42
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul3_4_w",
                            "outdata": "eternal_matmul3_4_w"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul3_3_w",
                            "outdata": "DEL_eternal_matmul3_3_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [],
                "prims": [
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "C",
                        "OC": "5C/4",
                        "sram_address": {
                            "indata": "layernorm2_out",
                            "outdata": "matmul3_4_out"
                        },
                        "dram_address": {
                            "data": "matmul3_data"
                        }
                    },
                    {
                        "type": "Merge_matmul",
                        "B": "B",
                        "T": "T/4",
                        "C": "5C/4",
                        "dim": 1,
                        "slice": 4,
                        "sram_address": {
                            "indata": "matmul3_1_out matmul3_2_out matmul3_3_out matmul3_4_out",
                            "outdata": "matmul3_out"
                        }
                    },
                    {
                        "type": "Gelu_f",
                        "N": "5BTC/4",
                        "sram_address": {
                            "indata": "matmul3_out",
                            "outdata": "gelu1_out"
                        },
                        "dram_address": {
                            "data": "gelu1_data",
                            "out": "TODO"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [],
                "prims": [
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "5C",
                        "OC": "C/4",
                        "sram_address": {
                            "indata": "_gelu1_out",
                            "outdata": "matmul4_1_out"
                        },
                        "dram_address": {
                            "data": "matmul4_data"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 23,
                "cast": [
                    {
                        "dest": 0,
                        "tag": 42
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul4_2_w",
                            "outdata": "eternal_matmul4_2_w"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul4_1_w",
                            "outdata": "DEL_eternal_matmul4_1_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [],
                "prims": [
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "5C",
                        "OC": "C/4",
                        "sram_address": {
                            "indata": "_gelu1_out",
                            "outdata": "matmul4_2_out"
                        },
                        "dram_address": {
                            "data": "matmul4_data"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 23,
                "cast": [
                    {
                        "dest": 0,
                        "tag": 42
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul4_3_w",
                            "outdata": "eternal_matmul4_3_w"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul4_2_w",
                            "outdata": "DEL_eternal_matmul4_2_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [],
                "prims": [
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "5C",
                        "OC": "C/4",
                        "sram_address": {
                            "indata": "_gelu1_out",
                            "outdata": "matmul4_3_out"
                        },
                        "dram_address": {
                            "data": "matmul4_data"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 1,
                "recv_tag": 23,
                "cast": [
                    {
                        "dest": 0,
                        "tag": 42
                    }
                ],
                "prims": [
                    {
                        "type": "parse_input",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul4_4_w",
                            "outdata": "eternal_matmul4_4_w"
                        }
                    },
                    {
                        "type": "parse_output",
                        "size": "5CC/4",
                        "sram_address": {
                            "indata": "eternal_matmul4_3_w",
                            "outdata": "DEL_eternal_matmul4_3_w"
                        }
                    }
                ]
            },
            {
                "recv_cnt": 0,
                "cast": [
                    {
                        "dest": 10
                    }
                ],
                "prims": [
                    {
                        "type": "Matmul_f",
                        "use_hw": false,
                        "B": "B",
                        "T": "T/4",
                        "C": "5C",
                        "OC": "C/4",
                        "sram_address": {
                            "indata": "gelu1_out",
                            "outdata": "matmul4_4_out"
                        },
                        "dram_address": {
                            "data": "matmul4_data"
                        }
                    },
                    {
                        "type": "Merge_matmul",
                        "B": "B",
                        "T": "T/4",
                        "C": "C/4",
                        "dim": 1,
                        "slice": 4,
                        "sram_address": {
                            "indata": "matmul4_1_out matmul4_2_out matmul4_3_out matmul4_4_out",
                            "outdata": "matmul4_out"
                        }
                    },
                    {
                        "type": "Residual_f",
                        "N": "BTC",
                        "sram_address": {
                            "indata": "residual1_out matmul4_out",
                            "outdata": "residual2_out"
                        },
                        "dram_address": {
                            "data": -1,
                            "out": "TODO"
                        }
                    }
                ]
            }
        ]
    }
]