{
  "vars": {
    "B": 1,
    "T": 128,
    "C": 768,
    "NH": 12,
    "L": 12,
    "3C": 2304,
    "4C": 3072,
    "BTC": 98304,
    "2BTC": 196608,
    "3BTC": 294912,
    "4BTC": 393216,
    "global_chip1_data": 0,
    "layernorm1_data_": 98304,
    "layernorm1_data": 96,
    "matmul1_data_": 99840,
    "matmul1_data": 97,
    "attention1_data_": 1871616,
    "attention1_data": 1829,
    "matmul2_data_": 2068224,
    "matmul2_data": 2020,
    "layernorm2_data_": 2658816,
    "layernorm2_data": 2600,
    "matmul3_data_": 2660352,
    "matmul3_data": 2605,
    "matmul4_data_": 5022720,
    "matmul4_data": 4915,
    "residual2_out_": 7382784,
    "residual2_out": 7220
  },
  "pipeline": 1,
  "source": [
    {
      "dest": 0,
      "size": "BTC"
    }
  ],
  "chips": [
    {
      "chip_id": 0,
      "source": [
        {
          "dest": 0,
          "size": "BTC"
        }
      ],
      "GridX": 4,
      "GridY": 4,
      "cores": [
        {
          "id": 0,
          "cast": [
            {
              "dest": 1,
              "critical": true
            }
          ],
          "recv_cnt": 1,
          "prim_refill": true,
          "prims": [
            {
              "type": "Layernorm_f",
              "B": "B",
              "T": "T",
              "C": "C",
              "sram_address": {
                "indata": "_input_label",
                "outdata": "layernorm1_out"
              },
              "dram_address": {
                "data": "layernorm1_data"
              }
            },
            {
              "type": "Matmul_f",
              "use_hw": false,
              "B": "B",
              "T": "T",
              "C": "C",
              "OC": "3C",
              "sram_address": {
                "indata": "layernorm1_out",
                "outdata": "matmul1_out"
              },
              "dram_address": {
                "data": "matmul1_data"
              }
            },
            {
              "type": "Attention_f",
              "B": "B",
              "T": "T",
              "C": "C",
              "NH": "NH",
              "sram_address": {
                "indata": "matmul1_out",
                "outdata": "attention1_out"
              },
              "dram_address": {
                "data": "attention1_data"
              }
            },
            {
              "type": "Matmul_f",
              "use_hw": false,
              "B": "B",
              "T": "T",
              "C": "C",
              "OC": "C",
              "sram_address": {
                "indata": "attention1_out",
                "outdata": "matmul2_out"
              },
              "dram_address": {
                "data": "matmul2_data"
              }
            },
            {
              "type": "Residual_f",
              "N": "BTC",
              "sram_address": {
                "indata": "input_label matmul2_out",
                "outdata": "residual1_out"
              },
              "dram_address": {
                "data": -1
              }
            },
            {
              "type": "Layernorm_f",
              "B": "B",
              "T": "T",
              "C": "C",
              "sram_address": {
                "indata": "_residual1_out",
                "outdata": "layernorm2_out"
              },
              "dram_address": {
                "data": "layernorm2_data"
              }
            },
            {
              "type": "Matmul_f",
              "B": "B",
              "T": "T",
              "C": "C",
              "OC": "4C",
              "sram_address": {
                "indata": "layernorm2_out",
                "outdata": "matmul3_out"
              },
              "dram_address": {
                "data": "matmul3_data"
              }
            },
            {
              "type": "Gelu_f",
              "N": "4BTC",
              "sram_address": {
                "indata": "matmul3_out",
                "outdata": "gelu1_out"
              },
              "dram_address": {
                "data": -1
              }
            },
            {
              "type": "Matmul_f",
              "B": "B",
              "T": "T",
              "C": "4C",
              "OC": "C",
              "sram_address": {
                "indata": "gelu1_out",
                "outdata": "matmul4_out"
              },
              "dram_address": {
                "data": "matmul4_data"
              }
            },
            {
              "type": "Residual_f",
              "N": "BTC",
              "sram_address": {
                "indata": "residual1_out matmul4_out",
                "outdata": "residual2_out"
              },
              "dram_address": {
                "data": -1,
                "out": "residual2_out"
              }
            }
          ]
        },
        {
          "id": 1,
          "cast": [
            {
              "dest": 2,
              "critical": true
            }
          ],
          "recv_cnt": 1,
          "prim_refill": true,
          "prim_copy": 0
        },
        {
          "id": 2,
          "cast": [
            {
              "dest": 3,
              "critical": true
            }
          ],
          "recv_cnt": 1,
          "prim_refill": true,
          "prim_copy": 0
        },
        {
          "id": 3,
          "cast": [
            {
              "dest": 4,
              "critical": true
            }
          ],
          "recv_cnt": 1,
          "prim_refill": true,
          "prim_copy": 0
        },
        {
          "id": 4,
          "cast": [
            {
              "dest": 5,
              "critical": true
            }
          ],
          "recv_cnt": 1,
          "prim_refill": true,
          "prim_copy": 0
        },
        {
          "id": 5,
          "cast": [
            {
              "dest": 6,
              "critical": true
            }
          ],
          "recv_cnt": 1,
          "prim_refill": true,
          "prim_copy": 0
        },
        {
          "id": 6,
          "cast": [
            {
              "dest": 7,
              "critical": true
            }
          ],
          "recv_cnt": 1,
          "prim_refill": true,
          "prim_copy": 0
        },
        {
          "id": 7,
          "cast": [
            {
              "dest": -1
            }
          ],
          "recv_cnt": 1,
          "prim_refill": true,
          "send_global_mem": 1,
          "prims": [
            {
              "type": "Layernorm_f",
              "B": "B",
              "T": "T",
              "C": "C",
              "sram_address": {
                "indata": "_input_label",
                "outdata": "layernorm1_out"
              },
              "dram_address": {
                "data": "layernorm1_data"
              }
            },
            {
              "type": "Matmul_f",
              "use_hw": false,
              "B": "B",
              "T": "T",
              "C": "C",
              "OC": "3C",
              "sram_address": {
                "indata": "layernorm1_out",
                "outdata": "matmul1_out"
              },
              "dram_address": {
                "data": "matmul1_data"
              }
            },
            {
              "type": "Attention_f",
              "B": "B",
              "T": "T",
              "C": "C",
              "NH": "NH",
              "sram_address": {
                "indata": "matmul1_out",
                "outdata": "attention1_out"
              },
              "dram_address": {
                "data": "attention1_data"
              }
            },
            {
              "type": "Matmul_f",
              "use_hw": false,
              "B": "B",
              "T": "T",
              "C": "C",
              "OC": "C",
              "sram_address": {
                "indata": "attention1_out",
                "outdata": "matmul2_out"
              },
              "dram_address": {
                "data": "matmul2_data"
              }
            },
            {
              "type": "Residual_f",
              "N": "BTC",
              "sram_address": {
                "indata": "input_label matmul2_out",
                "outdata": "residual1_out"
              },
              "dram_address": {
                "data": -1
              }
            },
            {
              "type": "Layernorm_f",
              "B": "B",
              "T": "T",
              "C": "C",
              "sram_address": {
                "indata": "_residual1_out",
                "outdata": "layernorm2_out"
              },
              "dram_address": {
                "data": "layernorm2_data"
              }
            },
            {
              "type": "Matmul_f",
              "B": "B",
              "T": "T",
              "C": "C",
              "OC": "4C",
              "sram_address": {
                "indata": "layernorm2_out",
                "outdata": "matmul3_out"
              },
              "dram_address": {
                "data": "matmul3_data"
              }
            },
            {
              "type": "Gelu_f",
              "N": "4BTC",
              "sram_address": {
                "indata": "matmul3_out",
                "outdata": "gelu1_out"
              },
              "dram_address": {
                "data": -1
              }
            },
            {
              "type": "Matmul_f",
              "B": "B",
              "T": "T",
              "C": "4C",
              "OC": "C",
              "sram_address": {
                "indata": "gelu1_out",
                "outdata": "matmul4_out"
              },
              "dram_address": {
                "data": "matmul4_data"
              }
            },
            {
              "type": "Residual_f",
              "N": "BTC",
              "sram_address": {
                "indata": "residual1_out matmul4_out",
                "outdata": "residual2_out"
              },
              "dram_address": {
                "data": -1,
                "out": "residual2_out"
              }
            },
            {
              "type": "Send_global_memory",
              "enable": 1,
              "addr": "matmul3_data_"
            }
          ]
        }
      ],
      "global_interface": {
        "prims": [
            {
              "type" : "Recv_global_memory",
              "seq" : 1
            },
            {
              "type" : "Print_msg",
              "seq" : 1,
              "message" : "global_msg1"
            },
            {
              "type" : "Print_msg",
              "seq" : 1,
              "message" : "global_msg2"
            },
            {
              "type" : "Print_msg",
              "seq" : 1,
              "message" : "global_msg3"
            },
            {
              "type" : "Print_msg",
              "seq" : 1,
              "message" : "global_msg4"
            },
            {
              "type" : "Print_msg",
              "seq" : 1,
              "message" : "global_msg5"
            },
            {
              "type" : "Print_msg",
              "seq" : 1,
              "message" : "global_msg6"
            },
            {
              "type" : "Print_msg",
              "seq" : 1,
              "message" : "global_msg7"
            },
            {
              "type" : "Print_msg",
              "seq" : 1,
              "message" : "global_msg8"
            },
            {
              "type" : "Wait_event",
              "seq" : 1,
              "event" : "global_event"
            }
        ]
      }
    }
  ]
}
