{
  "vars": {
    "B": 1,
    "T": 128,
    "C": 1024,
    "NH": 16,
    "L": 24,
    "3C": 3072,
    "4C": 4096,
    "BTC": 131072,
    "2BTC": 262144,
    "3BTC": 393216,
    "4BTC": 524288,
    "layernorm1_data_": 131072,
    "layernorm1_data": 128,
    "matmul1_data_": 133120,
    "matmul1_data": 130,
    "attention1_data_": 3281920,
    "attention1_data": 3205,
    "matmul2_data_": 3806208,
    "matmul2_data": 3717,
    "layernorm2_data_": 4855808,
    "layernorm2_data": 4742,
    "matmul3_data_": 4857856,
    "matmul3_data": 4744,
    "matmul4_data_": 9056256,
    "matmul4_data": 8844,
    "residual2_out_": 13251584,
    "residual2_out": 12941
  },
  "pipeline": 1,
  "source": [
    {
      "dest": 0,
      "size": "BTC"
    }
  ],
  "chips": [
    {
      "chip_id": 0,
      "GridX": 4,
      "GridY": 4,
      "cores": [
        {
          "id": 0,
          "cast": [
            {
              "dest": 1
            }
          ],
          "recv_cnt": 1,
          "prim_refill": true,
          "prims": [
            {
              "type": "Layernorm_f",
              "B": "B",
              "T": "T",
              "C": "C",
              "sram_address": {
                "indata": "_input_label",
                "outdata": "layernorm1_out"
              },
              "dram_address": {
                "data": "layernorm1_data"
              }
            },
            {
              "type": "Matmul_f",
              "use_hw": false,
              "B": "B",
              "T": "T",
              "C": "C",
              "OC": "3C",
              "sram_address": {
                "indata": "layernorm1_out",
                "outdata": "matmul1_out"
              },
              "dram_address": {
                "data": "matmul1_data"
              }
            },
            {
              "type": "Attention_f",
              "B": "B",
              "T": "T",
              "C": "3C",
              "NH": "NH",
              "sram_address": {
                "indata": "matmul1_out",
                "outdata": "attention1_out"
              },
              "dram_address": {
                "data": "attention1_data"
              }
            },
            {
              "type": "Matmul_f",
              "use_hw": false,
              "B": "B",
              "T": "T",
              "C": "C",
              "OC": "C",
              "sram_address": {
                "indata": "attention1_out",
                "outdata": "matmul2_out"
              },
              "dram_address": {
                "data": "matmul2_data"
              }
            },
            {
              "type": "Residual_f",
              "N": "BTC",
              "sram_address": {
                "indata": "input_label matmul2_out",
                "outdata": "residual1_out"
              },
              "dram_address": {
                "data": -1
              }
            },
            {
              "type": "Layernorm_f",
              "B": "B",
              "T": "T",
              "C": "C",
              "sram_address": {
                "indata": "_residual1_out",
                "outdata": "layernorm2_out"
              },
              "dram_address": {
                "data": "layernorm2_data"
              }
            },
            {
              "type": "Matmul_f",
              "B": "B",
              "T": "T",
              "C": "C",
              "OC": "4C",
              "sram_address": {
                "indata": "layernorm2_out",
                "outdata": "matmul3_out"
              },
              "dram_address": {
                "data": "matmul3_data"
              }
            },
            {
              "type": "Gelu_f",
              "N": "4BTC",
              "sram_address": {
                "indata": "matmul3_out",
                "outdata": "gelu1_out"
              },
              "dram_address": {
                "data": -1
              }
            },
            {
              "type": "Matmul_f",
              "B": "B",
              "T": "T",
              "C": "4C",
              "OC": "C",
              "sram_address": {
                "indata": "gelu1_out",
                "outdata": "matmul4_out"
              },
              "dram_address": {
                "data": "matmul4_data"
              }
            },
            {
              "type": "Residual_f",
              "N": "BTC",
              "sram_address": {
                "indata": "residual1_out matmul4_out",
                "outdata": "residual2_out"
              },
              "dram_address": {
                "data": -1,
                "out": "residual2_out"
              }
            }
          ]
        },
        {
          "id": 1,
          "cast": [
            {
              "dest": 2
            }
          ],
          "recv_cnt": 1,
          "prim_refill": true,
          "prim_copy": 0
        },
        {
          "id": 2,
          "cast": [
            {
              "dest": 3
            }
          ],
          "recv_cnt": 1,
          "prim_refill": true,
          "prim_copy": 0
        },
        {
          "id": 3,
          "cast": [
            {
              "dest": 4
            }
          ],
          "recv_cnt": 1,
          "prim_refill": true,
          "prim_copy": 0
        },
        {
          "id": 4,
          "cast": [
            {
              "dest": 5
            }
          ],
          "recv_cnt": 1,
          "prim_refill": true,
          "prim_copy": 0
        },
        {
          "id": 5,
          "cast": [
            {
              "dest": 6
            }
          ],
          "recv_cnt": 1,
          "prim_refill": true,
          "prim_copy": 0
        },
        {
          "id": 6,
          "cast": [
            {
              "dest": 7
            }
          ],
          "recv_cnt": 1,
          "prim_refill": true,
          "prim_copy": 0
        },
        {
          "id": 7,
          "cast": [
            {
              "dest": 8,
              "critical": true
            }
          ],
          "recv_cnt": 1,
          "prim_refill": true,
          "prim_copy": 0
        },
        {
          "id": 8,
          "cast": [
            {
              "dest": 9,
              "critical": true
            }
          ],
          "recv_cnt": 1,
          "prim_refill": true,
          "prim_copy": 0
        },
        {
          "id": 9,
          "cast": [
            {
              "dest": 10,
              "critical": true
            }
          ],
          "recv_cnt": 1,
          "prim_refill": true,
          "prim_copy": 0
        },
        {
          "id": 10,
          "cast": [
            {
              "dest": 11,
              "critical": true
            }
          ],
          "recv_cnt": 1,
          "prim_refill": true,
          "prim_copy": 0
        },
        {
          "id": 11,
          "cast": [
            {
              "dest": -1
            }
          ],
          "recv_cnt": 1,
          "prim_refill": true,
          "prim_copy": 0
        }
      ]
    }
  ]
}
