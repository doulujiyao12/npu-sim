{
    "mode": "gpu_pds",
    "requests": {
        "count": 20,
        "seq_len": 128,
        "arrival": [
            1
        ],
        "heads": 12,
        "kv_heads": 12,
        "eof_chance": 0.1,
        "prefill_stage": 2,
        "decode_stage": 2,
        "prefill_cores": 16,
        "decode_cores": 8,
        "batch_size": 2,
        "head_size": 64
    },
    "source": [
        {
            "label": "layernorm_1_in",
            "size": "BTC"
        }
    ],
    "chips": [
        {
            "chip_id": 0,
            "prefill_template": {
                "id": 0,
                "worklist": [
                    {
                        "recv_cnt": 1,
                        "prims": [
                            {
                                "type": "Layernorm_f_gpu",
                                "compose": {
                                    "grid_x": 4,
                                    "grid_y": 4,
                                    "block_x": 4,
                                    "block_y": 4,
                                    "require_sm": 4
                                },
                                "B": "B",
                                "T": "T",
                                "C": "C",
                                "address": {
                                    "indata": "layernorm_1_in",
                                    "outdata": "layernorm_1_out"
                                }
                            },
                            {
                                "type": "Matmul_f_gpu",
                                "compose": {
                                    "grid_x": 4,
                                    "grid_y": 4,
                                    "block_x": 4,
                                    "block_y": 4,
                                    "require_sm": 4
                                },
                                "B": "B",
                                "T": "T",
                                "C": "C",
                                "OC": "3C",
                                "address": {
                                    "indata": "layernorm_1_out",
                                    "outdata": "matmul_1_out"
                                }
                            },
                            {
                                "type": "Attention_f_gpu",
                                "compose": {
                                    "grid_x": 4,
                                    "grid_y": 4,
                                    "block_x": 4,
                                    "block_y": 4,
                                    "require_sm": 4
                                },
                                "B": "B",
                                "T": "T",
                                "C": "3C",
                                "NH": "NH",
                                "address": {
                                    "indata": "matmul_1_out",
                                    "outdata": "attention_1_out"
                                }
                            },
                            {
                                "type": "Matmul_f_gpu",
                                "compose": {
                                    "grid_x": 4,
                                    "grid_y": 4,
                                    "block_x": 4,
                                    "block_y": 4,
                                    "require_sm": 4
                                },
                                "B": "B",
                                "T": "T",
                                "C": "3C",
                                "OC": "C",
                                "address": {
                                    "indata": "attention_1_out",
                                    "outdata": "matmul_2_out"
                                }
                            },
                            {
                                "type": "Residual_f_gpu",
                                "compose": {
                                    "grid_x": 4,
                                    "grid_y": 4,
                                    "block_x": 4,
                                    "block_y": 4,
                                    "require_sm": 4
                                },
                                "N": "BTC",
                                "address": {
                                    "indata": "layernorm_1_in matmul_2_out",
                                    "outdata": "residual_1_out"
                                }
                            },
                            {
                                "type": "Layernorm_f_gpu",
                                "compose": {
                                    "grid_x": 4,
                                    "grid_y": 4,
                                    "block_x": 4,
                                    "block_y": 4,
                                    "require_sm": 4
                                },
                                "B": "B",
                                "T": "T",
                                "C": "C",
                                "address": {
                                    "indata": "residual_1_out",
                                    "outdata": "layernorm_2_out"
                                }
                            },
                            {
                                "type": "Matmul_f_gpu",
                                "compose": {
                                    "grid_x": 4,
                                    "grid_y": 4,
                                    "block_x": 4,
                                    "block_y": 4,
                                    "require_sm": 4
                                },
                                "B": "B",
                                "T": "T",
                                "C": "C",
                                "OC": "4C",
                                "address": {
                                    "indata": "layernorm_2_out",
                                    "outdata": "matmul_3_out"
                                }
                            },
                            {
                                "type": "Gelu_f_gpu",
                                "compose": {
                                    "grid_x": 4,
                                    "grid_y": 4,
                                    "block_x": 4,
                                    "block_y": 4,
                                    "require_sm": 4
                                },
                                "N": "4BTC",
                                "address": {
                                    "indata": "matmul_3_out",
                                    "outdata": "gelu_1_out"
                                }
                            },
                            {
                                "type": "Matmul_f_gpu",
                                "compose": {
                                    "grid_x": 4,
                                    "grid_y": 4,
                                    "block_x": 4,
                                    "block_y": 4,
                                    "require_sm": 4
                                },
                                "B": "B",
                                "T": "T",
                                "C": "4C",
                                "OC": "C",
                                "address": {
                                    "indata": "gelu_1_out",
                                    "outdata": "matmul_4_out"
                                }
                            },
                            {
                                "type": "Residual_f_gpu",
                                "compose": {
                                    "grid_x": 4,
                                    "grid_y": 4,
                                    "block_x": 4,
                                    "block_y": 4,
                                    "require_sm": 4
                                },
                                "N": "BTC",
                                "address": {
                                    "indata": "residual_1_out matmul_4_out",
                                    "outdata": "layernorm_1_in"
                                }
                            }
                        ]
                    }
                ]
            },
            "decode_template": {
                "id": 1,
                "worklist": [
                    {
                        "recv_cnt": 1,
                        "prims": [
                            {
                                "type": "Layernorm_f_gpu",
                                "compose": {
                                    "grid_x": 4,
                                    "grid_y": 4,
                                    "block_x": 4,
                                    "block_y": 4,
                                    "require_sm": 4
                                },
                                "B": "B",
                                "T": "T",
                                "C": "C",
                                "address": {
                                    "indata": "layernorm_1_in",
                                    "outdata": "layernorm_1_out"
                                }
                            },
                            {
                                "type": "Matmul_f_gpu",
                                "compose": {
                                    "grid_x": 4,
                                    "grid_y": 4,
                                    "block_x": 4,
                                    "block_y": 4,
                                    "require_sm": 4
                                },
                                "B": "B",
                                "T": "T",
                                "C": "C",
                                "OC": "3C",
                                "address": {
                                    "indata": "layernorm_1_out",
                                    "outdata": "matmul_1_out"
                                }
                            },
                            {
                                "type": "Attention_f_gpu",
                                "compose": {
                                    "grid_x": 4,
                                    "grid_y": 4,
                                    "block_x": 4,
                                    "block_y": 4,
                                    "require_sm": 4
                                },
                                "B": "B",
                                "T": "T",
                                "C": "3C",
                                "NH": "NH",
                                "address": {
                                    "indata": "matmul_1_out",
                                    "outdata": "attention_1_out"
                                }
                            },
                            {
                                "type": "Matmul_f_gpu",
                                "compose": {
                                    "grid_x": 4,
                                    "grid_y": 4,
                                    "block_x": 4,
                                    "block_y": 4,
                                    "require_sm": 4
                                },
                                "B": "B",
                                "T": "T",
                                "C": "3C",
                                "OC": "C",
                                "address": {
                                    "indata": "attention_1_out",
                                    "outdata": "matmul_2_out"
                                }
                            },
                            {
                                "type": "Residual_f_gpu",
                                "compose": {
                                    "grid_x": 4,
                                    "grid_y": 4,
                                    "block_x": 4,
                                    "block_y": 4,
                                    "require_sm": 4
                                },
                                "N": "BTC",
                                "address": {
                                    "indata": "layernorm_1_in matmul_2_out",
                                    "outdata": "residual_1_out"
                                }
                            },
                            {
                                "type": "Layernorm_f_gpu",
                                "compose": {
                                    "grid_x": 4,
                                    "grid_y": 4,
                                    "block_x": 4,
                                    "block_y": 4,
                                    "require_sm": 4
                                },
                                "B": "B",
                                "T": "T",
                                "C": "C",
                                "address": {
                                    "indata": "residual_1_out",
                                    "outdata": "layernorm_2_out"
                                }
                            },
                            {
                                "type": "Matmul_f_gpu",
                                "compose": {
                                    "grid_x": 4,
                                    "grid_y": 4,
                                    "block_x": 4,
                                    "block_y": 4,
                                    "require_sm": 4
                                },
                                "B": "B",
                                "T": "T",
                                "C": "C",
                                "OC": "4C",
                                "address": {
                                    "indata": "layernorm_2_out",
                                    "outdata": "matmul_3_out"
                                }
                            },
                            {
                                "type": "Gelu_f_gpu",
                                "compose": {
                                    "grid_x": 4,
                                    "grid_y": 4,
                                    "block_x": 4,
                                    "block_y": 4,
                                    "require_sm": 4
                                },
                                "N": "4BTC",
                                "address": {
                                    "indata": "matmul_3_out",
                                    "outdata": "gelu_1_out"
                                }
                            },
                            {
                                "type": "Matmul_f_gpu",
                                "compose": {
                                    "grid_x": 4,
                                    "grid_y": 4,
                                    "block_x": 4,
                                    "block_y": 4,
                                    "require_sm": 4
                                },
                                "B": "B",
                                "T": "T",
                                "C": "4C",
                                "OC": "C",
                                "address": {
                                    "indata": "gelu_1_out",
                                    "outdata": "matmul_4_out"
                                }
                            },
                            {
                                "type": "Residual_f_gpu",
                                "compose": {
                                    "grid_x": 4,
                                    "grid_y": 4,
                                    "block_x": 4,
                                    "block_y": 4,
                                    "require_sm": 4
                                },
                                "N": "BTC",
                                "address": {
                                    "indata": "residual_1_out matmul_4_out",
                                    "outdata": "layernorm_1_in"
                                }
                            }
                        ]
                    }
                ]
            }
        }
    ]
}