{
  "vars": {
    "B": 1,
    "T": 128,
    "C": 1280,
    "NH": 20,
    "L": 36,
    "3C": 3840,
    "4C": 5120,
    "BTC": 163840,
    "2BTC": 327680,
    "3BTC": 491520,
    "4BTC": 655360,
    "layernorm1_data_": 163840,
    "layernorm1_data": 160,
    "matmul1_data_": 166400,
    "matmul1_data": 163,
    "attention1_data_": 5085440,
    "attention1_data": 4967,
    "matmul2_data_": 5740800,
    "matmul2_data": 5607,
    "layernorm2_data_": 7380480,
    "layernorm2_data": 7210,
    "matmul3_data_": 7383040,
    "matmul3_data": 7215,
    "matmul4_data_": 13941760,
    "matmul4_data": 13620,
    "residual2_out_": 20496640,
    "residual2_out": 20022
  },
  "pipeline": 1,
  "source": [
    {
      "dest": 0,
      "size": "BTC"
    }
  ],
  "chips": [
    {
      "chip_id": 0,
      "GridX": 4,
      "GridY": 4,
      "cores": [
        {
          "id": 0,
          "cast": [
            {
              "dest": 1,
              "critical": true
            }
          ],
          "recv_cnt": 1,
          "prim_refill": true,
          "prims": [
            {
              "type": "Layernorm_f",
              "B": "B",
              "T": "T",
              "C": "C",
              "sram_address": {
                "indata": "_input_label",
                "outdata": "layernorm1_out"
              },
              "dram_address": {
                "data": "layernorm1_data"
              }
            },
            {
              "type": "Matmul_f",
              "use_hw": false,
              "B": "B",
              "T": "T",
              "C": "C",
              "OC": "3C",
              "sram_address": {
                "indata": "layernorm1_out",
                "outdata": "matmul1_out"
              },
              "dram_address": {
                "data": "matmul1_data"
              }
            },
            {
              "type": "Attention_f",
              "B": "B",
              "T": "T",
              "C": "C",
              "NH": "NH",
              "R": "R",
              "sram_address": {
                "indata": "matmul1_out",
                "outdata": "attention1_out"
              },
              "dram_address": {
                "data": "attention1_data"
              }
            },
            {
              "type": "Matmul_f",
              "use_hw": false,
              "B": "B",
              "T": "T",
              "C": "C",
              "OC": "C",
              "sram_address": {
                "indata": "attention1_out",
                "outdata": "matmul2_out"
              },
              "dram_address": {
                "data": "matmul2_data"
              }
            },
            {
              "type": "Residual_f",
              "N": "BTC",
              "sram_address": {
                "indata": "input_label matmul2_out",
                "outdata": "residual1_out"
              },
              "dram_address": {
                "data": -1
              }
            },
            {
              "type": "Layernorm_f",
              "B": "B",
              "T": "T",
              "C": "C",
              "sram_address": {
                "indata": "_residual1_out",
                "outdata": "layernorm2_out"
              },
              "dram_address": {
                "data": "layernorm2_data"
              }
            },
            {
              "type": "Matmul_f",
              "B": "B",
              "T": "T",
              "C": "C",
              "OC": "4C",
              "sram_address": {
                "indata": "layernorm2_out",
                "outdata": "matmul3_out"
              },
              "dram_address": {
                "data": "matmul3_data"
              }
            },
            {
              "type": "Gelu_f",
              "N": "4BTC",
              "sram_address": {
                "indata": "matmul3_out",
                "outdata": "gelu1_out"
              },
              "dram_address": {
                "data": -1
              }
            },
            {
              "type": "Matmul_f",
              "B": "B",
              "T": "T",
              "C": "4C",
              "OC": "C",
              "sram_address": {
                "indata": "gelu1_out",
                "outdata": "matmul4_out"
              },
              "dram_address": {
                "data": "matmul4_data"
              }
            },
            {
              "type": "Residual_f",
              "N": "BTC",
              "sram_address": {
                "indata": "residual1_out matmul4_out",
                "outdata": "residual2_out"
              },
              "dram_address": {
                "data": -1,
                "out": "residual2_out"
              }
            }
          ]
        },
        {
          "id": 1,
          "cast": [
            {
              "dest": 2,
              "critical": true
            }
          ],
          "recv_cnt": 1,
          "prim_refill": true,
          "prim_copy": 0
        },
        {
          "id": 2,
          "cast": [
            {
              "dest": 3,
              "critical": true
            }
          ],
          "recv_cnt": 1,
          "prim_refill": true,
          "prim_copy": 0
        },
        {
          "id": 3,
          "cast": [
            {
              "dest": 4,
              "critical": true
            }
          ],
          "recv_cnt": 1,
          "prim_refill": true,
          "prim_copy": 0
        },
        {
          "id": 4,
          "cast": [
            {
              "dest": 5,
              "critical": true
            }
          ],
          "recv_cnt": 1,
          "prim_refill": true,
          "prim_copy": 0
        },
        {
          "id": 5,
          "cast": [
            {
              "dest": 6,
              "critical": true
            }
          ],
          "recv_cnt": 1,
          "prim_refill": true,
          "prim_copy": 0
        },
        {
          "id": 6,
          "cast": [
            {
              "dest": 7,
              "critical": true
            }
          ],
          "recv_cnt": 1,
          "prim_refill": true,
          "prim_copy": 0
        },
        {
          "id": 7,
          "cast": [
            {
              "dest": 8,
              "critical": true
            }
          ],
          "recv_cnt": 1,
          "prim_refill": true,
          "prim_copy": 0
        },
        {
          "id": 8,
          "cast": [
            {
              "dest": 9,
              "critical": true
            }
          ],
          "recv_cnt": 1,
          "prim_refill": true,
          "prim_copy": 0
        },
        {
          "id": 9,
          "cast": [
            {
              "dest": 10,
              "critical": true
            }
          ],
          "recv_cnt": 1,
          "prim_refill": true,
          "prim_copy": 0
        },
        {
          "id": 10,
          "cast": [
            {
              "dest": 11,
              "critical": true
            }
          ],
          "recv_cnt": 1,
          "prim_refill": true,
          "prim_copy": 0
        },
        {
          "id": 11,
          "cast": [
            {
              "dest": -1
            }
          ],
          "recv_cnt": 1,
          "prim_refill": true,
          "prim_copy": 0
        }
      ]
    }
  ]
}
